ECHO OFF

SETLOCAL
SET CURRENT_DIR=%~dp0
SET DEV_PATH=..\..\..\src\quarto.ts

IF EXIST %CURRENT_DIR%%DEV_PATH% (
	
	IF "%QUARTO_ACTION%"=="" (
		SET QUARTO_ACTION=run
	)
	SET QUARTO_IMPORT_ARGMAP=--importmap=%CURRENT_DIR%\..\..\..\src\import_map.json

	IF "%QUARTO_TARGET%"=="" (
		SET QUARTO_TARGET=%CURRENT_DIR%\%DEV_PATH%
	)
	
	SET QUARTO_BIN_PATH=%CURRENT_DIR%
	SET QUARTO_SHARE_PATH=%CURRENT_DIR%\..\..\..\src\resources\
) ELSE (
	ECHO NO
)

SET QUARTO_DENO_OPTIONS=--unstable --allow-read --allow-write --allow-run --allow-env
deno %QUARTO_ACTION% %QUARTO_DENO_OPTIONS% %QUARTO_IMPORT_ARGMAP% %QUARTO_TARGET% %1

